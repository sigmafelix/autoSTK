% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/autofitVariogramST.r
\name{autofitVariogramST}
\alias{autofitVariogramST}
\title{Automatic Spatio-Temporal Variogram Fitting}
\usage{
autofitVariogramST(
  stf,
  formula,
  typestv = "sumMetric",
  candidate_model = c("Ste", "Exc", "Exp", "Wav"),
  guess_nugget = NULL,
  guess_psill = NULL,
  tlags = 0:6,
  cutoff = 20000,
  width = 500,
  aniso_method = "vgm",
  type_joint = "Exp",
  prodsum_k = NULL,
  surface = FALSE,
  measurement_error = c(0, 0, 0),
  cores = 1,
  verbose = FALSE
)
}
\arguments{
\item{stf}{A spatio-temporal data frame (STFDF or similar) containing the data to be modeled.}

\item{formula}{A formula specifying the response and explanatory variables.}

\item{typestv}{Character string specifying the type of spatio-temporal variogram model to fit. Options include "sumMetric", "separable", "productSum", "productSumOld", "simpleSumMetric", and "metric".}

\item{candidate_model}{Character vector of candidate spatial/temporal variogram models to consider (e.g., c("Ste", "Exc", "Exp", "Wav")).}

\item{guess_nugget}{Optional initial guess for the nugget parameter. If NULL, it is estimated automatically.}

\item{guess_psill}{Optional initial guess for the partial sill parameter. If NULL, it is estimated automatically.}

\item{tlags}{Integer vector specifying the temporal lags to use in the empirical variogram calculation.}

\item{cutoff}{Numeric value specifying the maximum spatial lag distance to consider.}

\item{width}{Numeric value specifying the width of spatial lag bins.}

\item{aniso_method}{Character string specifying the method for estimating spatio-temporal anisotropy ("vgm" or "linear").}

\item{type_joint}{Character string specifying the model type for the joint variogram component (e.g., "Exp").}

\item{prodsum_k}{Optional numeric value for the product-sum model parameter k. If NULL, it is estimated automatically.}

\item{surface}{Logical; if TRUE, computes and returns the variogram surface.}

\item{measurement_error}{Numeric vector of length 3 specifying measurement error for spatial, temporal, and joint variograms, respectively.}

\item{cores}{Integer specifying the number of CPU cores to use for parallel computation.}

\item{verbose}{Logical; if TRUE, prints progress and diagnostic messages.}
}
\value{
A list containing:
  \item{jointSTV}{The fitted spatio-temporal variogram model.}
  \item{empSTV}{The empirical spatio-temporal variogram.}
  \item{SpV}{The fitted spatial variogram model.}
  \item{TV}{The fitted temporal variogram model.}
  \item{STVsurface}{(Optional) The computed variogram surface, if \code{surface = TRUE}.}
}
\description{
Fits a spatio-temporal variogram model to a given spatio-temporal data frame using automatic parameter estimation.
}
\details{
This function automates the process of fitting a spatio-temporal variogram by:
\itemize{
  \item Computing empirical spatial and temporal variograms.
  \item Automatically selecting and fitting marginal models.
  \item Estimating spatio-temporal anisotropy.
  \item Constructing and fitting a joint spatio-temporal variogram model.
}
The function supports several popular spatio-temporal variogram structures, including separable, product-sum, and sum-metric models.
}
\examples{
library(spacetime)
library(sp)
library(stars)
library(sftime)
data(air)
stations <- st_as_sf(stations)
stations <- st_transform(stations, 'EPSG:3857')

airdf <- data.frame(PM10 = as.vector(air))
stations_full <- do.call(c, rep(stations, length(dates)))
dates_full <- rep(dates, each = nrow(stations))

rural <- cbind(airdf, time = dates_full, stations_full)

rural <- st_as_sftime(rural, sf_column_name = 'geometry')
rr <- rural[match(rural$time, dates[3001:3060], nomatch = FALSE, incomparables = FALSE) > 0, ]
rrstv <- autofitVariogramST(
 stf = rr, formula = PM10 ~ 1, surface = TRUE)
rrstv
}
\seealso{
\code{\link{vgmST}}, \code{\link{fit.StVariogram}}, \code{\link{marginal.variogramST}}
}
